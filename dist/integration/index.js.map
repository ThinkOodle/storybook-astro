{"version":3,"sources":["../../src/integration/index.ts"],"names":["require"],"mappings":";;;;AAUA,IAAMA,QAAAA,GAAU,aAAA,CAAc,MAAA,CAAA,IAAA,CAAY,GAAG,CAAA;AAI7C,SAAS,oBAAA,GAA+B;AAEtC,EAAA,MAAM,eAAA,GAAkBA,QAAAA,CAAQ,OAAA,CAAQ,yCAAyC,CAAA;AACjF,EAAA,MAAM,WAAA,GAAc,QAAQ,eAAe,CAAA;AAC3C,EAAA,OAAO,IAAA,CAAK,WAAA,EAAa,MAAA,EAAQ,aAAA,EAAe,gBAAgB,CAAA;AAClE;AAmBO,SAAS,mBAAA,CAAoB,OAAA,GAAmC,EAAC,EAAqB;AAC3F,EAAA,MAAM,EAAE,IAAA,GAAO,IAAA,EAAM,IAAA,GAAO,aAAY,GAAI,OAAA;AAE5C,EAAA,OAAO;AAAA,IACL,IAAA,EAAM,oCAAA;AAAA,IACN,KAAA,EAAO;AAAA,MACL,oBAAA,EAAsB,CAAC,EAAE,gBAAA,EAAkB,SAAQ,KAAM;AAEvD,QAAA,IAAI,YAAY,KAAA,EAAO;AAEvB,QAAA,MAAM,iBAAiB,oBAAA,EAAqB;AAE5C,QAAA,gBAAA,CAAiB;AAAA,UACf,EAAA,EAAI,uBAAA;AAAA,UACJ,IAAA,EAAM,WAAA;AAAA;AAAA,UAEN,IAAA,EAAM,CAAA,+zBAAA,CAAA;AAAA,UACN,UAAA,EAAY;AAAA,SACb,CAAA;AAAA,MACH,CAAA;AAAA,MACA,oBAAA,EAAsB,CAAC,EAAE,MAAA,EAAO,KAAM;AAEpC,QAAA,MAAA,CAAO,WAAA,CAAY,GAAA,CAAI,CAAC,GAAA,EAAK,KAAK,IAAA,KAAS;AACzC,UAAA,IAAI,GAAA,CAAI,QAAQ,qBAAA,EAAuB;AACrC,YAAA,GAAA,CAAI,SAAA,CAAU,gBAAgB,kBAAkB,CAAA;AAChD,YAAA,GAAA,CAAI,IAAI,IAAA,CAAK,SAAA,CAAU,EAAE,IAAA,EAAM,IAAA,EAAM,CAAC,CAAA;AACtC,YAAA;AAAA,UACF;AACA,UAAA,IAAA,EAAK;AAAA,QACP,CAAC,CAAA;AAAA,MACH;AAAA;AACF,GACF;AACF;AAEA,IAAO,mBAAA,GAAQ","file":"index.js","sourcesContent":["/**\n * Astro Integration for Storybook Dev Toolbar App\n * \n * Adds a Storybook icon to the Astro dev toolbar that links to the running Storybook instance.\n */\n\nimport type { AstroIntegration } from 'astro';\nimport { createRequire } from 'module';\nimport { dirname, join } from 'path';\n\nconst require = createRequire(import.meta.url);\n\n// Get the toolbar-app.js path relative to the package root\n// This avoids issues with import.meta.url when bundled\nfunction getToolbarEntrypoint(): string {\n  // Resolve the package.json to find the package root\n  const packageJsonPath = require.resolve('@anthropic/storybook-astro/package.json');\n  const packageRoot = dirname(packageJsonPath);\n  return join(packageRoot, 'dist', 'integration', 'toolbar-app.js');\n}\n\nexport interface StorybookToolbarOptions {\n  /**\n   * The port Storybook is running on\n   * @default 6006\n   */\n  port?: number;\n  \n  /**\n   * The host Storybook is running on\n   * @default 'localhost'\n   */\n  host?: string;\n}\n\n/**\n * Astro integration that adds a Storybook link to the dev toolbar\n */\nexport function storybookDevToolbar(options: StorybookToolbarOptions = {}): AstroIntegration {\n  const { port = 6006, host = 'localhost' } = options;\n  \n  return {\n    name: '@anthropic/storybook-astro/toolbar',\n    hooks: {\n      'astro:config:setup': ({ addDevToolbarApp, command }) => {\n        // Only add in dev mode\n        if (command !== 'dev') return;\n        \n        const entrypointPath = getToolbarEntrypoint();\n        \n        addDevToolbarApp({\n          id: 'storybook-toolbar-app',\n          name: 'Storybook',\n          // Official Storybook icon from https://github.com/storybookjs/brand\n          icon: `<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 52 64\" fill=\"none\"><path fill=\"#FF4785\" d=\"M50.273 2.923a3.12 3.12 0 0 1 .006.194v55.766a3.117 3.117 0 0 1-3.15 3.117l-42.14-1.869a3.108 3.108 0 0 1-3.006-2.997L.002 5.955A3.108 3.108 0 0 1 2.953 2.727L37.427.594l-.3 7.027a.466.466 0 0 0 .753.396l2.758-2.07 2.329 1.816a.467.467 0 0 0 .76-.381l-.26-7.155 3.466-.221a3.108 3.108 0 0 1 3.34 2.917Z\"/><path fill=\"#fff\" d=\"M29.403 23.369c0 1.213 8.254.636 9.362-.215 0-8.259-4.477-12.599-12.676-12.599-8.199 0-12.793 4.408-12.793 11.019 0 11.514 15.7 11.734 15.7 18.015 0 1.763-.872 2.81-2.791 2.81-2.5 0-3.489-1.264-3.373-5.561 0-.932-9.536-1.223-9.827 0-.74 10.414 5.815 13.417 13.316 13.417 7.269 0 12.967-3.834 12.967-10.776 0-12.34-15.933-12.01-15.933-18.125 0-2.48 1.861-2.81 2.966-2.81 1.163 0 3.256.203 3.082 4.825Z\"/></svg>`,\n          entrypoint: entrypointPath,\n        });\n      },\n      'astro:server:setup': ({ server }) => {\n        // Inject the Storybook URL into the client via a virtual module\n        server.middlewares.use((req, res, next) => {\n          if (req.url === '/__storybook-config') {\n            res.setHeader('Content-Type', 'application/json');\n            res.end(JSON.stringify({ port, host }));\n            return;\n          }\n          next();\n        });\n      },\n    },\n  };\n}\n\nexport default storybookDevToolbar;\n"]}